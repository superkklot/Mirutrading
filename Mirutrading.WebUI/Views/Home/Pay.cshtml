
@{
    ViewBag.Title = "Pay";
}

<input id="pay" type="button" value="立即支付" />

<script src="~/Scripts/Weixin/jweixin-1.1.0.js"></script>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
    $("#pay").click(function () {
        WeixinJSBridge.invoke(
            'getBrandWCPayRequest', {
                "appId": "wx2421b1c4370ec43b",     //公众号名称，由商户传入     
                "timeStamp": "1395712654",         //时间戳，自1970年以来的秒数     
                "nonceStr": "e61463f8efa94090b1f366cccfbbb444", //随机串     
                "package": "prepay_id=u802345jgfjsdfgsdg888",
                "signType": "MD5",         //微信签名方式：     
                "paySign": "70EA570631E4BB79628FBCA90534C63FF7FADD89" //微信签名 
            },
            function (res) {
                if (res.err_msg == "get_brand_wcpay_request:ok") {
                    alert("交易成功");
                }
                else {
                    alert("交易取消");
                }
            }
        );
    })

    function onBridgeReady() {
        
    }

    //if (typeof WeixinJSBridge == "undefined") {
    //    if (document.addEventListener) {
    //        document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
    //    } else if (document.attachEvent) {
    //        document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
    //        document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
    //    }
    //} else {
    //    onBridgeReady();
    //}
</script>



